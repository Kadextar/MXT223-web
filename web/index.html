<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –ú–•–¢-223</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- FontAwesome (Standard CDN) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Styles -->
    <link rel="preload" href="/static/styles.css" as="style">
    <link rel="stylesheet" href="/static/styles.css">
    <link rel="stylesheet" href="/static/search.css">
    <link rel="stylesheet" href="/static/install.css">
    <link rel="stylesheet" href="/static/toast.css">
    <link rel="manifest" href="/manifest.json">
    <link rel="icon" type="image/png" sizes="192x192" href="/static/icons/icon-192x192.png">
    <link rel="apple-touch-icon" href="/static/icons/icon-192x192.png">
    <meta name="description" content="–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∏ —Ä–µ–π—Ç–∏–Ω–≥–∏ –≥—Ä—É–ø–ø—ã –ú–•–¢-223. –í—Ö–æ–¥ –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤.">
    <meta property="og:title" content="–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –ú–•–¢-223">
    <meta property="og:description" content="–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∏ —Ä–µ–π—Ç–∏–Ω–≥–∏ –≥—Ä—É–ø–ø—ã –ú–•–¢-223.">
    <meta property="og:type" content="website">
    <meta property="og:image" content="/static/icons/icon-192x192.png">
    <meta name="theme-color" content="#eef2f6">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <!-- GLOBAL ERROR HANDLER FOR DEBUGGING -->
    <script>
        window.onerror = function (msg, url, line, col, error) {
            console.error('üö® Global Error:', {
                message: msg,
                location: `${url}:${line}:${col}`,
                stack: error ? error.stack : 'N/A'
            });
            // Only show simple error in empty state
            const loading = document.querySelector('.empty-state p');
            if (loading && loading.textContent.includes('–ó–∞–≥—Ä—É–∑–∫–∞')) {
                loading.textContent = "–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É.";
            }
        };
    </script>
    <style>
        /* Only Keep critical page-specifics if needed, removing theme overrides */
        .headers-container {
            display: none;
        }
    </style>
</head>

<body>
    <div class="background-globes">
        <div class="globe globe-1" style="background: rgba(59, 130, 246, 0.3);"></div>
        <div class="globe globe-2" style="background: rgba(139, 92, 246, 0.3);"></div>
        <div class="globe globe-3" style="background: rgba(0, 255, 157, 0.2);"></div>
    </div>

    <!-- Announcement: skeleton while loading, then banner or none -->
    <div id="announcement-skeleton" class="announcement-skeleton" aria-hidden="true">
        <span class="skeleton-line" style="max-width: 80%; height: 1rem;"></span>
    </div>
    <div id="announcement-banner" class="announcement-banner hidden">
        <div class="announcement-content">
            <span class="announcement-icon">üì£</span>
            <span class="announcement-text" id="announcement-text"></span>
            <button id="close-banner-btn" class="close-banner-btn" aria-label="–ó–∞–∫—Ä—ã—Ç—å">‚úï</button>
        </div>
    </div>

    <div class="app-container">
        <!-- New "Apple Style" Header -->
        <header class="header-greeting-container">
            <h1 class="greeting-date" id="greeting-date">–ó–∞–≥—Ä—É–∑–∫–∞...</h1>
            <p class="greeting-text">
                <span id="greeting-time">Good Morning</span>,
                <span id="user-name">Student</span>.
            </p>
            <p id="personal-tip" class="personal-tip" aria-live="polite"></p>
        </header>

        <nav class="week-nav" role="navigation" aria-label="–ù–µ–¥–µ–ª—è">
            <button type="button" class="nav-btn prev-week" id="prev-week-btn" aria-label="–ü—Ä–µ–¥—ã–¥—É—â–∞—è –Ω–µ–¥–µ–ª—è">‚Üê</button>
            <span class="current-week-label" id="week-date-range">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
            <button type="button" class="nav-btn next-week" id="next-week-btn" aria-label="–°–ª–µ–¥—É—é—â–∞—è –Ω–µ–¥–µ–ª—è">‚Üí</button>
        </nav>
        <div id="offline-banner" class="offline-banner hidden" role="status">
            <span class="offline-banner-icon">üì∂</span>
            <span>–†–µ–∂–∏–º –æ—Ñ–ª–∞–π–Ω. –î–∞–Ω–Ω—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å —É—Å—Ç–∞—Ä–µ–≤—à–∏–º–∏.</span>
        </div>
        <div id="stats-bar" class="stats-bar hidden" aria-label="–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞"></div>
        <div id="fav-filter-chip" class="fav-filter-chip hidden">
            <span>‚òÖ –ü–æ–∫–∞–∑–∞–Ω—ã –∏–∑–±—Ä–∞–Ω–Ω—ã–µ</span>
            <button type="button" class="fav-filter-chip-close" id="fav-filter-chip-close" aria-label="–ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ">√ó</button>
        </div>
        <div class="days-tabs" id="days-tabs">
            <!-- Tabs will be generated by JS -->
        </div>

        <div id="rate-after-lesson-banner" class="rate-after-lesson-banner hidden" aria-label="–û—Ü–µ–Ω–∏—Ç—å –ø–∞—Ä—É">
            <span id="rate-after-lesson-text"></span>
            <a href="/ratings.html" id="rate-after-lesson-link" class="rate-after-lesson-link">–û—Ü–µ–Ω–∏—Ç—å</a>
        </div>
        <div id="live-status" class="live-widget hidden">
            <!-- Live status injected by JS -->
        </div>
        <div id="next-lesson-widget" class="next-lesson-widget hidden" aria-label="–°–ª–µ–¥—É—é—â–∞—è –ø–∞—Ä–∞">
            <span class="next-lesson-label">–°–ª–µ–¥—É—é—â–∞—è –ø–∞—Ä–∞</span>
            <div id="next-lesson-content"></div>
        </div>

        <!-- Active poll (from admin) -->
        <div id="poll-block" class="poll-block hidden" aria-label="–û–ø—Ä–æ—Å">
            <div class="poll-inner">
                <h3 id="poll-question" class="poll-question"></h3>
                <div id="poll-options" class="poll-options"></div>
                <p id="poll-thanks" class="poll-thanks hidden">–°–ø–∞—Å–∏–±–æ –∑–∞ –≥–æ–ª–æ—Å!</p>
            </div>
        </div>

        <main class="schedule-container" id="schedule-container" aria-label="–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∑–∞–Ω—è—Ç–∏–π">
            <div class="empty-state schedule-skeleton" aria-busy="true" aria-live="polite">
                <div class="skeleton-line" style="width:60%;height:24px;margin:0 auto 12px"></div>
                <div class="skeleton-line" style="width:80%;height:20px;margin:0 auto 8px"></div>
                <div class="skeleton-line" style="width:90%;height:80px;margin:16px auto 8px"></div>
                <div class="skeleton-line" style="width:90%;height:80px;margin:8px auto"></div>
            </div>
        </main>

        <!-- PWA Install Banner (Android/Desktop) -->
        <div id="install-banner" class="install-banner hidden">
            <div class="install-banner-content">
                <div class="install-banner-icon">üì±</div>
                <div class="install-banner-text">
                    <h3>–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</h3>
                    <p>–ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø —Å –≥–ª–∞–≤–Ω–æ–≥–æ —ç–∫—Ä–∞–Ω–∞</p>
                </div>
                <div class="install-banner-actions">
                    <button id="install-btn" class="install-btn-primary">
                        –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
                    </button>
                    <button id="install-dismiss" class="install-btn-secondary">
                        –ü–æ–∑–∂–µ
                    </button>
                </div>
            </div>
        </div>

        <!-- iOS Install Instructions -->
        <div id="ios-install-instructions" class="ios-install-instructions hidden">
            <div class="ios-install-content">
                <h3>üì± –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ iPhone</h3>
                <div class="ios-install-steps">
                    <span>–ù–∞–∂–º–∏—Ç–µ</span>
                    <span>üì§ –ü–æ–¥–µ–ª–∏—Ç—å—Å—è</span>
                    <span>‚Üí</span>
                    <span>–ù–∞ —ç–∫—Ä–∞–Ω "–î–æ–º–æ–π"</span>
                </div>
                <button id="ios-close-btn" class="ios-close-btn">–ü–æ–Ω—è—Ç–Ω–æ</button>
            </div>
        </div>

        <!-- Note Modal -->
        <!-- Note Modal -->
        <div id="note-modal" class="modal hidden">
            <div class="modal-overlay" onclick="closeNoteModal()"></div>
            <div class="modal-content" style="max-width: 350px;">
                <h3 id="note-modal-title" style="margin-bottom: 15px;">–ó–∞–º–µ—Ç–∫–∞</h3>
                <div style="position: relative;">
                    <textarea id="note-input" rows="4" placeholder="–ó–∞–ø–∏—à–∏—Ç–µ –¥–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ –∏–ª–∏ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ..."
                        class="form-group note-textarea"></textarea>
                    <button type="button" id="note-voice-btn" class="note-voice-btn" title="–ì–æ–ª–æ—Å–æ–≤–æ–π –≤–≤–æ–¥" aria-label="–ì–æ–ª–æ—Å–æ–≤–æ–π –≤–≤–æ–¥">
                        <i class="fas fa-microphone"></i>
                    </button>
                </div>
                <div style="display: flex; gap: 10px;">
                    <button id="save-note-btn" class="submit-btn" onclick="saveNote()"
                        style="padding: 12px; margin: 0; font-size: 1rem;">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                    <button id="close-note-btn" class="back-btn" onclick="closeNoteModal()"
                        style="flex: 1;">–û—Ç–º–µ–Ω–∞</button>
                </div>
                <button id="delete-note-btn" onclick="deleteNote()"
                    style="width: 100%; margin-top: 10px; background: transparent; color: #ef4444; border: none; padding: 10px; cursor: pointer; display: none;">–£–¥–∞–ª–∏—Ç—å
                    –∑–∞–º–µ—Ç–∫—É</button>
            </div>
        </div>

        <!-- Bottom Navigation -->
        <nav class="profile-nav" role="navigation" aria-label="–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é">
            <a href="/" class="nav-link active" aria-current="page" aria-label="–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ"><i class="fas fa-th-large" aria-hidden="true"></i></a>
            <a href="/academics.html" class="nav-link" aria-label="–ü—Ä–µ–¥–º–µ—Ç—ã"><i class="fas fa-book" aria-hidden="true"></i></a>
            <a href="/ratings.html" class="nav-link" aria-label="–†–µ–π—Ç–∏–Ω–≥"><i class="fas fa-star" aria-hidden="true"></i></a>
            <a href="/profile.html" class="nav-link" aria-label="–ü—Ä–æ—Ñ–∏–ª—å"><i class="fas fa-user" aria-hidden="true"></i></a>
        </nav>
    </div>

    <!-- Scripts -->
    <!-- Scripts -->
    <script type="module" src="/static/theme.js"></script>
    <script type="module" src="/static/search.js"></script>
    <script type="module" src="/static/install.js"></script>
    <!-- app.js is the main controller -->
    <script type="module" src="/static/app.js?v=1.0.0"></script>

    <script>
        // Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', async () => {
                try {
                    const reg = await navigator.serviceWorker.register('/sw.js');
                    console.log('SW registered!', reg);
                } catch (err) {
                    console.log('SW registration failed:', err);
                }
            });
        }
    </script>
</body>

</html>