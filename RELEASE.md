# Чек-лист перед релизом

Перед выкладкой новой версии в production проверьте:

## Безопасность и конфигурация

- [ ] `ENV=production` в окружении деплоя
- [ ] `JWT_SECRET_KEY` задан и не равен дефолтному значению
- [ ] `DATABASE_URL` указывает на продовую БД (PostgreSQL рекомендуется)
- [ ] При использовании Redis: `REDIS_URL` задан
- [ ] При необходимости: `CORS_ORIGINS` ограничен доменом продакшена

## Функциональность

- [ ] Логин и refresh токенов работают
- [ ] Расписание загружается и отображается
- [ ] Рейтинги и отзывы по предметам работают
- [ ] Push-подписка (если включена) и отправка уведомлений при изменении расписания
- [ ] Админка: расписание, объявления, модерация отзывов

## Наблюдаемость

- [ ] `GET /health/live` возвращает 200 (liveness)
- [ ] `GET /health` возвращает 200 и `database: "connected"` (readiness)
- [ ] При наличии Redis в `GET /health` отображается статус Redis
- [ ] `GET /metrics` отдаёт метрики в формате Prometheus (если мониторинг настроен)
- [ ] Логи содержат `request_id`; при 5xx фронт показывает request_id в тосте

## Инфраструктура

- [ ] HTTPS включён; в production редирект HTTP → HTTPS и заголовок HSTS
- [ ] При использовании прокси: передаётся `X-Forwarded-Proto` и при необходимости `X-Forwarded-For` для rate limit по IP
- [ ] Рекомендуется HTTP/2 на уровне прокси/балансировщика (см. README)

## Фронт и PWA

- [ ] Версия в `pyproject.toml` обновлена при необходимости
- [ ] Статика и SW кэшируются; при деплое можно обновить `?v=` в ссылках на статику
- [ ] Критичные страницы (расписание, профиль, рейтинги) открываются и работают офлайн (PWA)

## После деплоя

- [ ] Проверить один полный сценарий: вход → расписание → профиль → выход
- [ ] Убедиться, что при 5xx пользователь видит тост с кодом запроса (request_id)
